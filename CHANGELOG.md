# 変更履歴 (Changelog)

## v2.0.0 - 認証機能・権限管理追加 (2025-11-04)

### 🎉 新機能

#### 🔐 認証システム
- **Gmailログイン機能を実装**
  - デモ版: 簡易ログイン（メールアドレス入力のみ）
  - 本番版: Firebase Authentication対応準備完了
  
#### 👥 権限管理システム
- **3段階の権限レベル**
  - 管理者 (Admin): 全機能へのアクセス
  - 編集者 (Editor): クライアント・担当者情報の編集
  - 担当者 (Staff): 自分のプロフィールのみ編集可能

#### 📝 編集履歴機能
- **自動記録**
  - 作成者と作成日時
  - 最終編集者と編集日時
- **プロフィール詳細画面で確認可能**

#### 🧑‍💼 担当者自己編集機能
- 担当者は自分のプロフィールのみ編集可能
- 権限チェックによる編集制限
- 編集時にログイン中のユーザー情報を自動記録

### 📋 担当者プロフィール項目の拡張

#### 新規追加項目
- ✅ **メールアドレス**（ログインIDとして使用）
- ✅ **電話番号**
- ✅ **LINE ID**
- ✅ **姉妹兄弟構成（自身）**
- ✅ **家族構成**
- ✅ **稼働可能時間**
- ✅ **自身の使命**
- ✅ **その他**

#### 更新項目
- 🔄 **DNA歴**（DNA卒業歴から改名、複数行対応）
- 🔄 **職業経歴**（詳細記述対応、複数行）
- 🔄 **公的な資格**（複数行、リスト表示対応）

#### 削除項目
- ❌ セラピスト歴（職業経歴に統合）

### 🎨 UI/UX改善

#### ログイン画面（NEW）
- シンプルで分かりやすいデザイン
- 権限の説明を表示
- デモ版であることを明示
- 水色ベースのデザイン

#### ユーザー情報バー（NEW）
- ログイン中のメールアドレス表示
- 権限バッジ（色分け）
  - 管理者: 水色
  - 編集者: 水色
  - 担当者: 水色
- ログアウトボタン

#### 担当者詳細画面
- 編集履歴表示エリア追加（青色）
- セクションごとに色分けされたカード
  - 基本情報: 水色
  - 連絡先: 水色
  - 家族構成: 紫ピンク
  - DNA歴: 水色
  - 職業経歴: 水色
  - 資格: 緑
  - 稼働時間: 青
  - 使命: 黄色
  - その他: グレー
- アイコン付きで視認性向上

#### 担当者フォーム
- セクションごとにグループ化
  - 基本情報
  - 連絡先情報
  - 家族構成
  - 専門情報
  - 使命・その他
- 必須項目の明示（*マーク）
- 権限チェックによる編集制限表示

### 📁 新規ファイル

```
src/
├── components/
│   └── Login.js              # ログイン画面
├── contexts/
│   └── AuthContext.js        # 認証コンテキスト
└── config/
    └── firebaseConfig.js     # Firebase設定（テンプレート）
```

### 🔄 更新ファイル

```
src/
├── App.js                     # 認証フロー統合、ログアウト機能
├── components/
│   ├── StaffManagement.js    # 認証統合、権限チェック
│   ├── StaffForm.js          # 新項目追加、権限チェック
│   ├── StaffDetail.js        # 編集履歴表示、権限ベースのボタン表示
│   └── StaffList.js          # 変更なし
└── utils/
    └── staffStorageUtils.js  # 編集履歴関数追加
```

### 🔧 技術的な変更

#### 認証システム
- React Context API を使用した認証状態管理
- LocalStorageでのセッション管理（デモ版）
- Firebase Authentication対応の準備

#### 権限管理
- ロールベースアクセス制御（RBAC）
- コンポーネントレベルでの権限チェック
- 階層的な権限システム（admin > editor > staff）

#### データ構造
- 担当者データに以下を追加:
  ```javascript
  {
    email: string,           // ログインID
    phone: string,
    lineId: string,
    siblingsStructure: string,
    familyStructure: string,
    availableHours: string,
    mission: string,
    otherInfo: string,
    createdBy: string,      // 作成者メールアドレス
    createdAt: string,      // 作成日時（ISO形式）
    lastEditBy: string,     // 最終編集者メールアドレス
    lastEditAt: string      // 最終編集日時（ISO形式）
  }
  ```

### 📚 ドキュメント

#### 新規作成
- **SETUP_GUIDE.md** - 詳細なセットアップ手順
  - インストール方法
  - ログイン手順
  - 権限の理解
  - Firebase設定方法
  - トラブルシューティング

#### 更新
- **README.md** - v2.0の新機能を反映
  - 認証機能の説明
  - 権限システムの表
  - 使い方ガイド
  - Firebase設定の概要

### 🔒 セキュリティ

#### デモモード
- パスワード認証なし（開発・テスト用）
- LocalStorageでのデータ管理
- ⚠️ 本番環境での使用は非推奨

#### 本番環境対応
- Firebase Authentication対応準備
- HTTPS必須の明示
- セキュリティルール設定の推奨
- バックエンドAPIでの権限検証推奨

### 🐛 バグ修正

- StaffManagementでの編集時の状態更新の改善
- プロフィール編集後の詳細ビュー更新の修正
- 権限チェックの一貫性向上

### 💡 既知の制限事項

- Firebase Authenticationは未実装（テンプレートのみ）
- パスワードリセット機能なし
- 多要素認証なし
- バックエンドAPIなし（全てフロントエンドで完結）

---

## v1.0.0 - 初期リリース (2025-11-03)

### 機能
- ✅ クライアント管理
  - 登録・編集・削除
  - セッション記録管理
  - スピリチュアルナンバー自動計算
- ✅ 担当者管理
  - プロフィール登録・編集・削除
  - 基本項目（7項目）
- ✅ データエクスポート
  - クライアント情報（CSV）
  - セッション記録（CSV）
  - 全データバックアップ（JSON）
- ✅ 統計情報
  - 担当者別クライアント数
  - 性別分布
  - 担当者別セッション数
  - 根本感情TOP10
  - 月別売上統計
  - 担当者別売上統計

### デザイン
- 水色（cyan）ベースの爽やかなカラースキーム
- レスポンシブデザイン（PC・タブレット・スマホ対応）
- Tailwind CSSによるスタイリング

### 技術スタック
- React 18
- Tailwind CSS (CDN)
- lucide-react（アイコン）
- LocalStorage API（データ永続化）
